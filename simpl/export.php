<?php/*** Base Class for Exporting** @author Nick DeNardis <nick@design-man.com>*/class Export extends Form{	/**	* @var DbTemplate Object 	*/	var $db_data;	/**	* @var array	*/	var $display;	/**	* @var string	*/	var $filename;	/**	* @var string	*/	var $directory;	/**	* Class Constructor	*	* Creates an Export Object Built on the Database Template	*	* @param DBTemplate Object	* @return NULL	*/	function Export($dbTemplate, $display='', $filename='', $directory=''){		// Made sure they are passing a DbTemplate		if (is_object($dbTemplate))			$this->db_data = $dbTemplate;					// Set the Local Variables		$this->display = $display;		$this->filename = $filename;		$this->directory = $directory;	}		/**	* XLS	*	* Creates and XLS file from the List of Items in the DBTemplate	*	* @return BOOL	*/	function XLS(){		// Make sure there is a list of items		if (!is_array($this->db_data->fields))			return false;					// Filter these Charictors		$bad_output = array("\n", "\r", "\t");				// Rearrange the Fields if there is a custom display		$show = array();		if(is_array($this->display)){			foreach($this->display as $key=>$data)				$show[$data] = ($db_data->fields[$data]->label != '')?$db_data->fields[$data]->label:ucfirst(str_replace('_',' ',$data));		}else{			if (is_array($this->db_data->fields))				foreach($this->db_data->fields as $key=>$data)					$show[$key] = ($data->label != '')?$data->label:ucfirst(str_replace('_',' ',$key));		}				// Loop through all the fields to get the Title		foreach($show as $key=>$column)			$csv_output .= $column . "\t";				// Create a New Line		$csv_output = substr($csv_output,0,-1) . "\n";			// If there are items listed in the object		if (is_array($this->db_data->list))			foreach($this->db_data->list as $item){				// Loop through all the fields				foreach($show as $key=>$column){					$csv_output .= str_replace($bad_output, '', $item[$key]) . "\t";				}				$csv_output = substr($csv_output,0,-1) . "\n";			}			header("Content-type: application/vnd.ms-excel");		header("Content-disposition: attachment; filename=" .  str_replace(' ','_',strtolower($this->db_data->table)) . '_' . date("Y-m-d") . ".xls");		print $csv_output;		exit;  	}}?>